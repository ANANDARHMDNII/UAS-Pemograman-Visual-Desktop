@page
@model DataPembayaranModel
@{
    Layout = null;
}

<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Cappunabara - Data Pembayaran Admin">
    <title>Cappunabara - Data Pembayaran</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="~/assets/css/cappunabara_home.css">
    <link rel="stylesheet" href="~/assets/css/admin.css">
</head>

<body>
    <!-- Navigation Header -->
    <header class="navbar">
        <div class="nav-container">
            <a href="/" class="nav-logo">
                <span class="logo-emoji">â˜•</span>
                <span class="logo-text">Cappunabara Admin</span>
            </a>

            <nav class="nav-menu">
                <a href="/DataPesanan" class="nav-link">ğŸ“‹ Data Pesanan</a>
                <a href="/DataPembayaran" class="nav-link active">ğŸ’³ Data Pembayaran</a>
                <a href="/RiwayatPesanan" class="nav-link">ğŸ“œ Riwayat Pesanan</a>
                <a href="/Order" class="nav-link">ğŸ›’ Kembali ke Order</a>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <!-- Page Header -->
            <div class="page-header">
                <div class="header-content">
                    <h1 class="page-title">ğŸ’³ Data Pembayaran</h1>
                    <p class="page-subtitle">Kelola dan pantau semua transaksi pembayaran</p>
                </div>
                
                <div class="header-actions">
                    <button class="btn-refresh" id="refreshData" onclick="loadPaymentData()">
                        <span>ğŸ”„</span> Refresh
                    </button>
                    <button class="btn-save" id="saveAllData" onclick="saveAllPaymentData()">
                        <span>ğŸ’¾</span> Simpan Semua
                    </button>
                    <button class="btn-export" id="exportData" onclick="exportPaymentToCSV()">
                        <span>ğŸ“¥</span> Export CSV
                    </button>
                </div>
            </div>

            <!-- Payment Statistics -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">ğŸ’°</div>
                    <div class="stat-content">
                        <div class="stat-value" id="totalPayments">Rp 0</div>
                        <div class="stat-label">Total Pembayaran</div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">ğŸ’³</div>
                    <div class="stat-content">
                        <div class="stat-value" id="cashPayments">Rp 0</div>
                        <div class="stat-label">Pembayaran Cash</div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">ğŸ¦</div>
                    <div class="stat-content">
                        <div class="stat-value" id="transferPayments">Rp 0</div>
                        <div class="stat-label">Transfer Bank</div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“±</div>
                    <div class="stat-content">
                        <div class="stat-value" id="ewalletPayments">Rp 0</div>
                        <div class="stat-label">E-Wallet</div>
                    </div>
                </div>
            </div>

            <!-- Payment Method Chart -->
            <div class="chart-section">
                <div class="chart-container">
                    <h3>Distribusi Metode Pembayaran</h3>
                    <div class="payment-chart" id="paymentChart">
                        <div class="chart-item">
                            <div class="chart-bar cash-bar" id="cashBar"></div>
                            <div class="chart-label">Cash</div>
                            <div class="chart-value" id="cashPercentage">0%</div>
                        </div>
                        <div class="chart-item">
                            <div class="chart-bar transfer-bar" id="transferBar"></div>
                            <div class="chart-label">Transfer</div>
                            <div class="chart-value" id="transferPercentage">0%</div>
                        </div>
                        <div class="chart-item">
                            <div class="chart-bar ewallet-bar" id="ewalletBar"></div>
                            <div class="chart-label">E-Wallet</div>
                            <div class="chart-value" id="ewalletPercentage">0%</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Filters -->
            <div class="filters-section">
                <div class="filter-group">
                    <label for="paymentDateFilter">Filter Tanggal:</label>
                    <select id="paymentDateFilter" onchange="filterPayments()">
                        <option value="all">Semua Waktu</option>
                        <option value="today">Hari Ini</option>
                        <option value="week">Minggu Ini</option>
                        <option value="month">Bulan Ini</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label for="paymentMethodFilter">Metode Pembayaran:</label>
                    <select id="paymentMethodFilter" onchange="filterPayments()">
                        <option value="all">Semua Metode</option>
                        <option value="cash">Cash</option>
                        <option value="transfer">Transfer Bank</option>
                        <option value="ewallet">E-Wallet</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label for="paymentSearchFilter">Cari:</label>
                    <input type="text" id="paymentSearchFilter" placeholder="Cari berdasarkan nama atau nomor pesanan..." onkeyup="filterPayments()">
                </div>
            </div>

            <!-- Payment Data Table -->
            <div class="table-container">
                <table class="data-table" id="paymentsTable">
                    <thead>
                        <tr>
                            <th>No</th>
                            <th>No Pesanan</th>
                            <th>Tgl Pembayaran</th>
                            <th>Pelanggan</th>
                            <th>Metode Pembayaran</th>
                            <th>Subtotal</th>
                            <th>Pajak (10%)</th>
                            <th>Total Pembayaran</th>
                            <th>Status</th>
                            <th>Aksi</th>
                        </tr>
                    </thead>
                    <tbody id="paymentsTableBody">
                        <!-- Data will be loaded here -->
                    </tbody>
                </table>
                
                <div class="empty-state" id="paymentEmptyState" style="display: none;">
                    <div class="empty-icon">ğŸ’³</div>
                    <h3>Belum Ada Data Pembayaran</h3>
                    <p>Data pembayaran akan muncul di sini setelah ada transaksi</p>
                </div>
            </div>

            <!-- Pagination -->
            <div class="pagination-container">
                <div class="pagination-info">
                    Menampilkan <span id="paymentShowingStart">0</span> - <span id="paymentShowingEnd">0</span> dari <span id="paymentTotalRecords">0</span> data
                </div>
                <div class="pagination" id="paymentPagination">
                    <!-- Pagination buttons will be generated here -->
                </div>
            </div>
        </div>
    </main>

    <!-- Payment Detail Modal -->
    <div class="modal" id="paymentDetailModal">
        <div class="modal-container">
            <div class="modal-header">
                <h2 class="modal-title">Detail Pembayaran</h2>
                <button class="modal-close" onclick="closePaymentDetail()">âœ•</button>
            </div>
            <div class="modal-body" id="paymentDetailContent">
                <!-- Payment details will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Overlay -->
    <div class="overlay" id="overlay" onclick="closeAllModals()"></div>

    <!-- JavaScript -->
    <script src="~/assets/js/admin-payments.js"></script>
    <script src="~/debug-edit-functionality.js"></script>
</body>

</html>